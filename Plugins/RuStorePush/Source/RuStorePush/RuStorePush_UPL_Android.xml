<?xml version="1.0" encoding="utf-8"?>
<root xmlns:android="http://schemas.android.com/apk/res/android">

  <prebuildCopies>
    <copyDir src="$S(PluginDir)/Private/Java" dst="$S(BuildDir)/src/com/Plugins/RuStorePush" />
  </prebuildCopies>

  <resourceCopies>
    <copyDir src="$S(PluginDir)/ThirdParty/Android" dst="$S(BuildDir)/libs" />
  </resourceCopies>

  <addElement tag="application" name="ru.rustore.unitysdk.RuStoreUnityApplication" />

  <androidManifestUpdates>
    <addElements tag="application">
      <service
        xmlns:tools="http://schemas.android.com/tools"
        android:name="ru.rustore.unitysdk.pushclient.RuStoreUnityMessagingService"
        android:exported="true"
        tools:ignore="ExportedService">
        <intent-filter>
          <action android:name="ru.rustore.sdk.pushclient.MESSAGING_EVENT" />
        </intent-filter>
      </service>
    </addElements>
  </androidManifestUpdates>
  
  <buildGradleAdditions>
    <insert>
      ext.push_type = ''
      
      if (project.hasProperty('rustore_sdk_type')) {
        push_type = rustore_sdk_type
      }
      
      dependencies {
        // RuStore Push
        implementation ("ru.rustore.sdk:pushclient:0.1.8$push_type")
        implementation fileTree(include: ["RuStoreUnityPushClient${push_type}.aar"], dir: 'src/main/libs')
      }
    </insert>
  </buildGradleAdditions>

</root>
